<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Tienda StreetWear 3D</title>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<style>
body{
font-family:Arial;
background:#f5f5f5;
color:#222;
text-align:center;
transition:0.3s;
}
.dark{background:#111;color:white;}

#productos{display:flex;flex-wrap:wrap;gap:20px;justify-content:center;}

.card{
border:1px solid #ccc;
padding:10px;
width:200px;
background:white;
}
.dark .card{background:#222;}

button{padding:8px;margin:5px;cursor:pointer;}

.pagar{background:green;color:white;font-size:18px;}

.modal{
display:none;
position:fixed;
top:0;left:0;
width:100%;height:100%;
background:rgba(0,0,0,0.6);
justify-content:center;
align-items:center;
}

.modal-content{
background:white;
padding:20px;
position:relative;
}

.cerrar{
position:absolute;
top:5px;
right:10px;
cursor:pointer;
font-size:20px;
}
</style>
</head>

<body>

<h1>StreetWear Shop</h1>

<input type="text" id="buscador" placeholder="Buscar prenda...">
<select id="filtro">
<option value="todos">Todos</option>
<option value="hoodies">Hoodies</option>
<option value="playeras">Playeras</option>
<option value="pantalones">Pantalones</option>
</select>

<button onclick="toggleModo()">üåô / ‚òÄÔ∏è</button>

<section id="productos"></section>

<h2>üõí Carrito</h2>
<ul id="carrito"></ul>

<p>Subtotal: $<span id="subtotal">0</span></p>
<p>IVA: $<span id="iva">0</span></p>
<p>Total: $<span id="total">0</span></p>

<button class="pagar" onclick="pagar()">PAGAR COMPRA</button>

<!-- MODAL 3D -->
<div id="modal3d" class="modal">
<div class="modal-content">
<span class="cerrar" onclick="cerrarModal()">‚úñ</span>
<model-viewer id="modelo3d"
src=""
auto-rotate
camera-controls
style="width:100%;height:400px;">
</model-viewer>
</div>
</div>

<script>

emailjs.init("TU_PUBLIC_KEY");

const productos=[
{nombre:"Hoodie Black",precio:900,categoria:"hoodies",modelo:"https://modelviewer.dev/shared-assets/models/Astronaut.glb"},
{nombre:"Playera Oversize",precio:450,categoria:"playeras",modelo:"https://modelviewer.dev/shared-assets/models/Astronaut.glb"},
{nombre:"Pantal√≥n Cargo",precio:700,categoria:"pantalones",modelo:"https://modelviewer.dev/shared-assets/models/Astronaut.glb"}
];

let carrito=[];

function render(){
let cont=document.getElementById("productos");
let busqueda=document.getElementById("buscador").value.toLowerCase();
let filtro=document.getElementById("filtro").value;

cont.innerHTML="";

productos.filter(p=>{
return (filtro=="todos"||p.categoria==filtro)
&& p.nombre.toLowerCase().includes(busqueda);
})
.forEach(p=>{
cont.innerHTML+=`
<div class="card">
<h3>${p.nombre}</h3>
<p>$${p.precio}</p>
<button onclick='agregar(${JSON.stringify(p)})'>Agregar</button>
<button onclick='ver3D("${p.modelo}")'>Ver 3D</button>
</div>
`;
});
}

render();

document.getElementById("buscador").addEventListener("input",render);
document.getElementById("filtro").addEventListener("change",render);

function agregar(prod){
carrito.push(prod);
mostrarCarrito();
}

function mostrarCarrito(){
let lista=document.getElementById("carrito");
lista.innerHTML="";
let subtotal=0;

carrito.forEach(p=>{
lista.innerHTML+=`<li>${p.nombre} - $${p.precio}</li>`;
subtotal+=p.precio;
});

let iva=subtotal*0.16;
let total=subtotal+iva;

document.getElementById("subtotal").innerText=subtotal.toFixed(2);
document.getElementById("iva").innerText=iva.toFixed(2);
document.getElementById("total").innerText=total.toFixed(2);
}

function pagar(){
if(carrito.length==0){
alert("Tu carrito est√° vac√≠o");
return;
}

let total=document.getElementById("total").innerText;

emailjs.send("TU_SERVICE_ID","TU_TEMPLATE_ID",{
mensaje:"Compra realizada por $" + total
}).then(()=>{
alert("Compra enviada a tu Gmail üì©");
carrito=[];
mostrarCarrito();
});
}

function toggleModo(){
document.body.classList.toggle("dark");
}

function ver3D(modelo){
document.getElementById("modelo3d").src=modelo;
document.getElementById("modal3d").style.display="flex";
}

function cerrarModal(){
document.getElementById("modal3d").style.display="none";
}

window.onclick=function(e){
if(e.target==document.getElementById("modal3d")){
cerrarModal();
}
}

</script>
</body>
</html>
